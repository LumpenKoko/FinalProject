<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 
 
<mapper namespace="memberMapper">
	<resultMap type="Member" id="memberResult">
		<result column="USER_NO" property="userNo"/>
		<result column="USER_ID" property="userId"/>
		<result column="USER_PWD" property="userPwd"/>
		<result column="USER_NAME" property="userName"/>
		<result column="USER_NICKNAME" property="userNickname"/>
		<result column="USER_GENDER" property="userGender"/>
		<result column="USER_EMAIL" property="userEmail"/>
		<result column="ENROLL_DATE" property="enrollDate"/>
		<result column="MODIFY_DATE" property="modifyDate"/>
		<result column="STATUS" property="status"/>
		<result column="USER_BIRTHDAY" property="userBirthday"/>
		<result column="USER_PHONE" property="userPhone"/>
		<result column="USER_KIND" property="userKind"/>
</resultMap>

	<select id="loginMember" resultMap="memberResult">
		SELECT USER_NO,
			   USER_ID,
			   USER_PWD,
			   USER_NAME,
			   USER_NICKNAME,
			   USER_GENDER,
			   USER_EMAIL,
			   ENROLL_DATE,
			   MODIFY_DATE,
			   USER_BIRTHDAY,
			   USER_PHONE,
			   USER_KIND
		  FROM MEMBER
		 WHERE USER_ID = #{userId}
		   AND STATUS = 'true'
	</select>	
	
	<select id="checkMemberId" resultType="_int">
		SELECT COUNT(*)
		FROM MEMBER
		WHERE USER_ID = #{checkId}	
	</select>
	
	<insert id="insertCommonMember">
		INSERT INTO MEMBER
			(
			USER_NO,
			USER_ID,
			USER_PWD,
			USER_NAME,
			USER_NICKNAME,
			USER_GENDER,
			USER_EMAIL,
			USER_BIRTHDAY,
			USER_PHONE,
			USER_KIND
			)
		VALUES
			(
			NEXTVAL('SEQ_USER'),
			#{userId},
			#{userPwd},
			#{userName},
			#{userNickname},
			#{userGender},
			#{userEmail},
			#{userBirthday},
			#{userPhone},
			#{userKind}
			)
	</insert>
	
	<insert id="insertCommonMember">
		INSERT INTO MEMBER
			(
			USER_NO,
			USER_ID,
			USER_PWD,
			USER_NAME,
			USER_GENDER,
			USER_EMAIL,
			USER_BIRTHDAY,
			USER_PHONE,
			USER_KIND
			)
		VALUES
			(
			NEXTVAL('SEQ_USER'),
			#{userId},
			#{userPwd},
			#{userName},
			#{userGender},
			#{userEmail},
			#{userBirthday},
			#{userPhone},
			#{userKind}
			)
	</insert>
	
	<insert id="insertLocation">
		INSERT INTO LOCATION
			(
			USER_NO,
			USER_ID,
			USER_PWD,
			USER_NAME,
			USER_GENDER,
			USER_EMAIL,
			USER_BIRTHDAY,
			USER_PHONE,
			USER_KIND
			)
		VALUES
			(
			NEXTVAL('SEQ_USER'),
			#{userId},
			#{userPwd},
			#{userName},
			#{userGender},
			#{userEmail},
			#{userBirthday},
			#{userPhone},
			#{userKind}
			)
	</insert>

	<update id="updateMember">
		UPDATE MEMBER
		   SET USER_ID = #{userId},
		       USER_NAME = #{userName},
		       USER_NICKNAME = #{userNickname},
		       USER_GENDER = #{userGender},
		       USER_BIRTHDAY = #{userBirthday},
		       USER_EMAIL = #{userEmail},
		       MODIFY_DATE = current_timestamp
		WHERE USER_ID = #{userId}
	</update>

</mapper>